= form_for @income, multipart: true do |f|
  .row
    .col.s12
      %span.bold (*) Required fields

  - if @income.errors.any?
    #errors.red-text.center.bold An error occured

  .row.top-space
    .input-field.col.s12.m4
      = f.select :source, options_for_select(Income.sources.keys,:source), class: 'source-select'
      = f.label :source, 'Source (*)'
      %small.red-text#source_error= @income.errors.full_messages_for(:source).to_sentence
    .input-field.col.s12.m4
      = f.text_field :invoice_number, data: { length: '50' }
      = f.label :invoice_number, 'Invoice number (*)'
      %small.red-text#invoice_number_error= @invoice.errors.full_messages_for(:invoice_number).to_sentence
    .input-field.col.s12.m4
      = f.select :provider_id, options_from_collection_for_select(@providers,:id,:name,@income.provider_id), {prompt: 'Choose an option'}, class: 'provider-select'
      = f.label :provider_id, 'Provider (*)'
      %small.red-text#provider_error= @income.errors.full_messages_for(:provider).to_sentence
      = link_to 'More', provider_information_incomes_path, remote: true, class: 'hidden', id: 'provider_information_link'

  .row
    .input-field.col.s12.m3
      = f.select :country_id, options_from_collection_for_select(@countries,:id,:name,@income.country_id),{ prompt: 'Choose an option' }, class: 'country-select'
      = f.label :country_id, 'Country (*)'
      %small.red-text#country_error= @income.errors.full_messages_for(:country).to_sentence
    #provider_information{class: "#{'hidden' unless @expense.id.present?}" }
      .input-field.col.s12.m3
        = text_field_tag :ruc, @income.provider.try(:ruc), class: 'ruc-field', disabled: true
        = label_tag :ruc, 'Provider RUC'
      .input-field.col.s12.m3
        = text_field_tag :address, @income.provider.try(:address), class: 'address-field', disabled: true
        = label_tag :address, 'Provider address'
      .input-field.col.s12.m3
        = text_field_tag :phone, @income.provider.try(:phone), class: 'phone-field', disabled: true
        = label_tag :phone, 'Provider phone'

  .row
    .input-field.col.s12.m4
      = f.text_field :description, data: { length: '200'}
      = f.label :description, 'Description (*)'
      %small.red-text#description_error= @income.errors.full_messages_for(:description).to_sentence
    .input-field.col.s12.m4
      = f.select :currency_id, options_from_collection_for_select(@currencies,:id,:name,@income.currency_id)
      = f.label :currency_id, 'Currency (*)'
      %small.red-text#currency_error= @income.errors.full_messages_for(:currency).to_sentence
    .input-field.col.s12.m4
      = f.number_field :amount, step: 'any', class: 'amout-field'
      = f.label :amount, 'Total amount (*)'
      %small.red-text#amount_error= @income.errors.full_messages_for(:amount).to_sentence

  .row
    .input-field.col.s12.m4
      = f.text_field :billing_at, class: 'datepicker', value: @income.billing_date.try(:strftime,"%Y-%m-%d")
      = f.label :billing_at, 'Billing at (*)'
      %small.red-text#billing_at_error= @income.errors.full_messages_for(:billing_at).to_sentence

  .row
    .col.s12.m2
      %label With fee
    .col.s12.m10
      .switch.top-space
        %label
          No
          = f.check_box :with_fee, class: 'with-fee-toggle'
          %span.lever
          Yes

  %div{class: "row fees-container #{'hidden' if !@expense.with_fee }" }
    .col.s12
      = f.label :fees, 'Fees'
    .col.s12.top-space
      #fees
        = f.fields_for :fees do |fee_form|
          = render 'fee_fields', f: fee_form
      %p= link_to_add_association 'Add a fee', f, :fees

  .row
    .input-field.col.s12.m4
      = f.select :payment_type, options_for_select(Expense.payment_types.keys,:payment_type), {}, class: 'payment-type-select'
      = f.label :payment_type

  %div{class: "row transference-container #{'hidden' unless @expense.transference?}"}
    .input-field.col.s12.m3
      = f.select :bank_id, options_from_collection_for_select(@banks,:id,:name,@expense.bank_id)
      = f.label :bank_id
    .input-field.col.s12.m3
      = f.text_field :account_number
      = f.label :account_number
    .input-field.col.s12.m3
      = f.text_field :cci
      = f.label :cci, 'CCI'
    .input-field.col.s12.m3
      = f.email_field :contact_email
      = f.label :contact_email

  %div{class: "row upon-delivery-container #{'hidden' unless @expense.upon_delivery?}"}
    .input-field.col.s12.m4
      = f.text_field :place_of_delivery
      = f.label :place_of_delivery
    .input-field.col.s12.m4
      = f.text_field :delivery_at, class: 'datepicker'
      = f.label :delivery_at

